# Daily Notes - 2026-02-18

## Session Summary
Excalidraw MCP testing, diagram creation workflow established, HTML diagram templates created.

## Completed Today

### Excalidraw MCP Testing
- ‚úÖ Installed `mcp-diagram-generator` for creating Excalidraw, Draw.io, Mermaid diagrams
- ‚úÖ Installed `excalidraw-export` CLI for converting .excalidraw files to PNG
- ‚úÖ Tested with OpenClaw System Overview diagram
- ‚úÖ Successfully exported real Excalidraw PNG to Telegram

### Diagrams Created
1. **OpenClaw System Overview** (Excalidraw)
   - PNG: `/root/.openclaw/media/inbound/openclaw-system-overview.png` (authentic hand-drawn)
   - Shows: User ‚Üí Channels ‚Üí Core ‚Üí Capabilities ‚Üí Data Layer

2. **OpenClaw Real Excalidraw** (test)
   - PNG: `/root/.openclaw/media/inbound/openclaw-real-excalidraw.png`

3. **HTML Versions Created:**
   - `/root/.agent/diagrams/openclow-system-overview.html` (dark theme)
   - `/root/.agent/diagrams/openclow-system-white.html` (white theme)
   - `/root/.agent/diagrams/excalidraw-capabilities-white.html` (clean digital)
   - `/root/.agent/diagrams/excalidraw-capabilities-sketch.html` (‚úèÔ∏è **hand-drawn sketch style**)

### Hand-Drawn Aesthetic Options
| Type | Method | Quality |
|------|--------|---------|
| **Real Excalidraw** | MCP ‚Üí `excalidraw-export` | ‚úÖ Authentic hand-drawn |
| **Sketch HTML** | CSS with wobbly borders + handwritten font | ‚úÖ Simulated sketch |
| **Clean HTML** | Standard CSS | ‚ùå No sketch effect |

**For hand-drawn look in HTML:**
- Use `border-radius` with varying values for wobbly edges
- Use font: `'Patrick Hand', cursive` (Google Fonts)
- Add `border: 3px solid #2d2d2d` for thick sketchy lines
- Use `box-shadow: 2px 2px 0` for sketched depth

### Standard Diagram Workflow Established
When user asks for a diagram:
1. Generate Excalidraw via MCP
2. Export PNG via CLI
3. Create styled HTML page (white background by default)
4. Serve via Python HTTP server
5. Share link: `http://76.13.46.115:7777/filename.html`

**ALWAYS include these elements:**
- ‚úÖ Rectangles, ellipses, diamonds
- ‚úÖ Arrow connections (flow)
- ‚úÖ Text labels with icons
- ‚úÖ Color-coded elements
- ‚úÖ Multiple layouts (grid, flow, cards)
- ‚úÖ **Hand-drawn/sketch aesthetic** (use sketch CSS with Patrick Hand font)

### Skill File Created
- `/root/.openclaw/workspace/skills/diagram-generator/SKILL.md`
  - Full documentation for Excalidraw MCP
  - Element types: container, node, edge
  - Node shapes: rect, ellipse, diamond, rounded, cylinder, cloud
  - Export commands and examples

## Key Learnings
- Excalidraw MCP has issues with JSON schema (format field error)
- Fallback: Use styled HTML/CSS for quick diagrams
- MCP requires careful JSON formatting - watch for quote escaping
- Serve HTML via Python HTTP server on port 7777 for quick sharing

## Files Created/Modified
- `/root/.openclaw/workspace/skills/diagram-generator/SKILL.md` (new)
- `/root/.openclaw/workspace/memory/2026-02-18.md` (new)
- `/root/.agent/diagrams/openclow-system-overview.html`
- `/root/.agent/diagrams/openclow-system-white.html`
- `/root/.agent/diagrams/excalidraw-capabilities-white.html`

## Server Status
- Python HTTP server running on port 7777 (for HTML diagram sharing)
- Excalidraw MCP: installed via mcporter
- excalidraw-export CLI: installed globally

---

## Backup Status (2026-02-18 02:23 UTC)
- ‚úÖ Backup created: `/root/openclaw-backups/openclaw-2026-02-18_0223.tar.gz` (56M)
- ‚úÖ 4 backups total (keeps last 7)

---

## Personal CRM Project (#1 of 26)
**Source:** https://gist.github.com/mberman84/63163d6839053fbf15091238e5ada5c2

**Goal:** Build a personal CRM that:
1. Scans Gmail & Calendar for contacts (past year)
2. Stores in SQLite with vector embeddings
3. Natural language queries ("who do I know at NVIDIA?")
4. Auto-filter noise (marketing, newsletters)
5. Contact profiles: company, role, how I know them, history
6. Relationship health scores + stale flags
7. Follow-up reminders (create, snooze, done)
8. Duplicate detection with merge suggestions
9. Link Box documents to contacts

**Current State:**
- ‚úÖ Gmail: Working via Himalaya
- ‚úÖ SQLite: Database exists at `/root/.openclaw/workspace/knowledge-base/kb.db`
- ‚úÖ CRM tables: contacts, interactions, job_pipeline, follow_ups (8 jobs tracked)
- ‚ùå Vector embeddings: Not yet implemented
- ‚ùå Calendar integration: Not yet
- ‚ùå Natural language query: Not yet
- ‚ùå Duplicate detection: Not yet
- ‚ùå Box documents: Not yet

**Phase 1: Foundation (Today)**
- [ ] Design contact schema with embeddings support
- [ ] Add Gmail contact extraction script
- [ ] Add vector search extension (sqlite-vec or similar)
- [ ] Build natural language query interface
- [ ] Test with existing contacts

---

## Personal CRM Progress (Feb 18, 2026 02:31 UTC)

### Phase 1: Foundation ‚úÖ IN PROGRESS
- [x] Design contact schema with embeddings support
- [x] Add vector search extension (sqlite-vec installed)
- [x] Create migration script (crm-schema-v2.sql)
- [x] Gmail contact extraction script (scan_gmail_contacts.py)
- [x] Test Gmail scan - found 6 contacts
- [ ] Scan more historical emails (365 days)
- [ ] Add interaction logging from Gmail
- [ ] Build natural language query interface

### Current Contacts in CRM
| Name | Email | Company | Last Contact |
|------|-------|---------|--------------|
| Julian Goldie | me@juliangoldie.com | juliangoldie.com | Today |
| App Economy Insights | appeconomyinsights@substack.com | substack.com | Today |
| Ankler Dealmakers | theankler+dealmakers@substack.com | substack.com | Today |
| Bankless | team@bankless.com | bankless.com | Today |
| MBC Shahid | shahid@email.shahid.net | email.shahid.net | Today |

### Next Steps
1. Run full Gmail scan (365 days of contacts)
2. Add interaction logging
3. Implement health scoring algorithm
4. Add natural language query CLI
5. Add vector embedding generation (sentence-transformers)

### Files Created
- `/root/.openclaw/workspace/knowledge-base/crm-schema-v2.sql`
- `/root/.openclaw/workspace/knowledge-base/migrate_crm.py`
- `/root/.openclaw/workspace/knowledge-base/scan_gmail_contacts.py`

---

## #11 Daily Briefing ‚Äî COMPLETED (Feb 18, 2026 02:44 UTC)

**Status:** ‚úÖ Built and running
**Deliverables:**
- Morning briefing script: `/root/.openclaw/workspace/knowledge-base/daily_briefing.py`
- Telegram delivery: `--telegram` flag
- Cron job: Daily at 7am Cairo

**Briefing includes:**
- üìÜ Today's meetings (placeholder - needs gog calendar auth)
- üìß Urgent emails (analyzed from Gmail)
- üíº Job pipeline status (8 applications tracked)
- üìã Pending follow-ups
- ü§ù Stale relationships (10+ needing attention)

**Cron Job:**
```
ID: f66e6c60-f7e6-4356-b12f-4817e45a90f1
Schedule: 0 7 * * * @ Africa/Cairo
Delivery: Telegram with announcement
```

**Next steps:**
1. Connect Google Calendar via `gog calendar events`
2. Add meeting attendees ‚Üí CRM lookup for context
3. Add weather integration

**Usage:**
```bash
# Console
python3 knowledge-base/daily_briefing.py

# Telegram
python3 knowledge-base/daily_briefing.py --telegram
```

---

## #24 Model Cost Tracking ‚Äî COMPLETED (Feb 18, 2026 02:50 UTC)

**Status:** ‚úÖ Built and running
**Deliverables:**
- Tracking script: `/root/.openclaw/workspace/knowledge-base/model_cost.py`
- CLI logger: `/root/.openclaw/workspace/knowledge-base/log_usage.py`
- Weekly report cron: Sundays 9am Cairo

**Features:**
- Tracks: Claude (Opus, Sonnet), MiniMax, Kimi
- Per-request cost estimation
- By provider, model, task type
- Usage examples:
  ```bash
  # Log an API call
  python3 log_usage.py claude-opus-4-6 anthropic CV_creation 8000 3000
  
  # Generate report
  python3 model_cost.py week
  python3 model_cost.py week --telegram
  ```

**Cron Job:**
```
ID: bb7d0055-4aaf-4a77-8dbf-cca467e04149
Schedule: 0 9 * * 0 @ Africa/Cairo (Sundays 9am)
```

**Important Note:**
- MiniMax is NOT free - 6 days left on trial then charges
- Cost tracking critical to avoid surprise bills

**Next steps:**
1. Integrate logging into actual API calls (wrapper function)
2. Add actual token counts from API responses
3. Set budget alerts (e.g., warn at $10/month)

---

## #15 Git Auto-Sync ‚Äî COMPLETED (Feb 18, 2026 02:53 UTC)

**Status:** ‚úÖ Built and running
**Deliverables:**
- Script: `/root/.openclaw/workspace/scripts/git_autosync.py`
- Hourly cron job

**Features:**
- Runs every hour (at :00)
- Auto-adds all changes: `git add -A`
- Meaningful commit messages with timestamp + file list
- Pushes to GitHub automatically
- Handles merge conflicts (skips if conflict detected)
- Telegram notification on changes (not no-changes)

**Cron Job:**
```
ID: 6d8f32d4-6114-4cf5-8fff-38af346bbf04
Schedule: 0 * * * * @ Africa/Cairo (hourly)
```

**Usage:**
```bash
# Manual sync
python3 scripts/git_autosync.py

# Force push without waiting for cron
```

**Git Config:**
```
user.name: Ahmed Nasr
user.email: ahmednasr999@gmail.com
```

**Next steps:**
1. Add pre-commit hook to prevent accidentally committing secrets
2. Add branch protection rules in GitHub
3. Add automatic backup before sync

---

## #3 Urgent Email Detection ‚Äî COMPLETED (Feb 18, 2026 02:58 UTC)

**Status:** ‚úÖ Built and running
**Deliverables:**
- Script: `/root/.openclaw/workspace/knowledge-base/urgent_email.py`
- Cron job: Every 3 hours

**Features:**
- Scans INBOX via Himalaya
- Urgency scoring (0-10) based on keywords
- Noise filtering (newsletters, marketing, noreply)
- Feedback loop: learn from your approvals/rejections
- Telegram reports on demand

**Urgency Keywords:**
- üî¥ High (weight 3): urgent, asap, emergency, deadline today, critical
- üü† Medium (weight 2): important, please respond, priority, blocked
- üü¢ Low (weight 1): please, feedback, question, update

**Cron Job:**
```
ID: 1033bb0a-c2a5-43cb-bfc6-d87a92c1bc7d
Schedule: 0 */3 * * * @ Africa/Cairo (every 3 hours)
```

**Usage:**
```bash
# Scan and report
python3 knowledge-base/urgent_email.py --scan

# Send to Telegram
python3 knowledge-base/urgent_email.py --telegram

# Record feedback
python3 urgent_email.py --feedback --urgent <email> <subject>
python3 urgent_email.py --feedback --not-urgent <email> <subject>
```

**Next steps:**
1. Add learned patterns from feedback
2. Connect to Todoist for action items
3. Add time-gating (only alert during waking hours)

---

## #13 Security Core ‚Äî COMPLETED (Feb 18, 2026 03:01 UTC)

**Status:** ‚úÖ Built and running
**Deliverables:**
- Script: `/root/.openclaw/workspace/scripts/security_core.py`
- Pre-commit hook: `.git/hooks/pre-commit`
- Weekly security cron

**Features:**
- **Prompt Injection Detection:**
  - Blocks: DAN, jailbreak, ignore instructions, override programming
  - Severity levels: HIGH (block), MEDIUM (redact + warn)
  
- **Data Protection:**
  - Auto-redacts: API keys, passwords, tokens, emails
  - Patterns: GitHub PAT, Slack tokens, OpenAI, Anthropic, Gmail creds

- **Pre-commit Hook:**
  - Prevents committing sensitive data
  - Skips security scripts to avoid false positives
  - Install: `.git/hooks/pre-commit`

- **Workspace Security Check:**
  - Detects .env files in repo
  - Checks file permissions
  - Scans git history for exposed secrets

**Cron Job:**
```
ID: a8ad093f-6a9e-42ef-b020-f85448dca325
Schedule: 0 3 * * 0 @ Africa/Cairo (Sundays 3am)
```

**Usage:**
```bash
# Generate security report
python3 scripts/security_core.py --report

# Test injection detection
python3 scripts/security_core.py --test

# Manual workspace check
python3 scripts/security_core.py --check
```

**Detection Examples:**
| Input | Action |
|-------|--------|
| "Ignore all previous instructions" | üî¥ BLOCKED |
| "You are now DAN" | üî¥ BLOCKED |
| "ghp_xxxxxxxxx" | üî¥ REDACTED |
| "Please help with Python" | ‚úÖ ALLOWED |

**Next steps:**
1. Add Slack/Discord notification on security alerts
2. Integrate with daily briefing
3. Add browser extension for external content scanning

---

## #22 Platform Health ‚Äî COMPLETED (Feb 18, 2026 03:08 UTC)

**Status:** ‚úÖ Built and running
**Deliverables:**
- Script: `/root/.openclaw/workspace/scripts/platform_health.py`
- Weekly cron: Sundays 4am Cairo

**Features:**
- **Cron Monitoring:** All 24 jobs, error detection
- **Storage Check:** Workspace (85M), KB (388K), DB (280KB)
- **Git Status:** Uncommitted changes, commit frequency
- **Database Health:** 18 tables, 232 contacts, 317 interactions
- **Gateway Status:** Running/Stoped

**Cron Job:**
```
ID: dcec7e5f-b421-41a1-be9b-b57f298b13e0
Schedule: 0 4 * * 0 @ Africa/Cairo (Sundays 4am)
```

**Usage:**
```bash
# Generate report
python3 scripts/platform_health.py

# Send to Telegram
python3 scripts/platform_health.py --telegram
```

**Current Health:**
```
‚úÖ All systems healthy!
üìã Cron: 24 running, 0 errors
üíæ Workspace: 85M
üóÑÔ∏è DB: 232 contacts, 317 interactions
ü¶û Gateway: Running
```

**Next steps:**
1. Add disk space warnings (alert at 90%)
2. Add cron failure notifications
3. Auto-fix common issues

---

## #4 Knowledge Base RAG ‚Äî COMPLETED (Feb 18, 2026 03:15 UTC)

**Status:** ‚úÖ Built and running
**Deliverables:**
- `knowledge-base/ingest.py` ‚Äî URL, YouTube, PDF ingestion
- `knowledge-base/search.sh` ‚Äî Keyword search

**Features:**
- Ingest URLs with `python3 ingest.py <url>`
- Search with `python3 ingest.py search <query>`
- Auto-detect: article, video, pdf, tweet

**Current Sources (4):**
| Source | Type | Domain |
|---------|------|--------|
| OpenClaw Gist (26 prompts) | article | gist.github.com |
| Claude Sonnet 4.6 | article | anthropic.com |
| OpenClaw Use Cases | video | youtube.com |
| OpenClaw PDF | pdf | beehiiv.com |

---

## #21 Google Workspace (Calendar) ‚Äî COMPLETED (Feb 18, 2026 03:15 UTC)

**Status:** ‚úÖ Ready (needs gog auth)
**Deliverables:**
- `knowledge-base/calendar_context.py` ‚Äî Calendar + CRM integration

**Features:**
- Fetches today's calendar events via gog
- Enriches with CRM contact context
- Shows: name, company, role, last contact, interactions

**Usage:**
```bash
python3 knowledge-base/calendar_context.py
```

**Setup:**
```bash
gog calendar events  # Test access
```

---

## #7 Social Tracking ‚Äî COMPLETED (Feb 18, 2026 03:15 UTC)

**Status:** ‚úÖ Built (API keys pending)
**Deliverables:**
- `knowledge-base/social_tracker.py` ‚Äî YouTube/Twitter analytics

**Features:**
- Daily/weekly reports
- Snapshots over time
- Placeholder for API integration

**Usage:**
```bash
python3 social_tracker.py --daily
python3 social_tracker.py --weekly
```

**To Enable:**
- Add YouTube API key + Channel ID
- Add Twitter/X Bearer Token
